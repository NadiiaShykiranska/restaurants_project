<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"/>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
    <link rel="stylesheet" href="//code.jquery.com/ui/1.11.4/themes/smoothness/jquery-ui.css"/>
    <script src="//code.jquery.com/jquery-1.10.2.js"></script>
    <script src="//code.jquery.com/ui/1.11.4/jquery-ui.js"></script>
    <title>Restaurant Revisor Admin</title>
</head>
<body>
<div id="admin_main">
    <div>Restaurant Revisor Admin</div>
    <div id = "add_new_review">
        <p><button id = "add_new_button" class="restaurant_name_button" onclick="addNewReview()">Add new Review</button></p>
    </div>
    <div id = "admin_restaurants_list">
        <div><p>Edit existing Reviews</p></div>
    </div>
</div>
<div id="admin_edit_form">
    <div id = "review_details_editable">
        <div id="admin_review_details_name">
            <label>Restaurant Name:</label>
            <input type = "text" class="admin_edit_field" id = "admin_restaurant_name"/>
        </div>
        <div id="admin_review_details_location">
            <label> Location:</label>
            <input type = "text" class="admin_edit_field" id = "admin_restaurant_location"/>
        </div>
        <div id="admin_review_details_cuisine">
            <label> Cuisine:</label>
            <input type = "text" class="admin_edit_field" id = "admin_restaurant_cuisine"/>
        </div>
        <div id="admin_review_details_interior">
            <label> Interior:</label>
            <input type = "text" class="admin_edit_field" id = "admin_restaurant_interior"/>
        </div>
        <div id="admin_review_details_service">
            <label> Service:</label>
            <input type = "text" class="admin_edit_field" id = "admin_restaurant_service"/>
        </div>
        <div id="admin_review_details_review">
            <label> Review:</label>
            <input type = "text" class="admin_edit_field" id = "admin_restaurant_review"/>
        </div>
    </div>
    <div id="admin_buttons">
        <button id="cancel_review_button" onclick = "hideForm()">Cancel</button>
        <button id="save_review_button" onclick = "hideForm()">Save</button>
    </div>
</div>
    <script th:inline="javascript">
        var reviews_list = [[${reviews}]];
        $(document).ready(function() {
            var index = 0;
            while (index != reviews_list.length){
                addButton(reviews_list[index]);
                index++;
            }
        });
        $("#admin_edit_form").hide();

        function addButton(reviewObject){
            $("#admin_restaurants_list").append("<div> \
            <button class='+"restaurant_name_button"+' onclick='+"openReviewDetailsPage(this)"+'>" + reviewObject.name + "</button></div>");
        }

        function openReviewDetailsPage(Object){
        $.ajax({
                url : 'showReview',
                type: 'GET',
                dataType: 'json',
                contentType: 'application/json',
                mimeType: 'application/json',
                data : ({
                    restaurantName : Object.innerText
                }),
                success: function (reviewDetails) {
                    $("#admin_restaurant_name").val(reviewDetails.name);
                    $("#admin_restaurant_location").val(reviewDetails.location);
                    $("#admin_restaurant_cuisine").val(reviewDetails.cuisine);
                    $("#admin_restaurant_interior").val(reviewDetails.interior);
                    $("#admin_restaurant_service").val(reviewDetails.service);
                    $("#admin_restaurant_review").val(reviewDetails.review);
                    $("#admin_edit_form").show();
                    $("#admin_main").hide();
                }
            });
        }

        function addNewReview(){
            $(".admin_edit_field").val("");
            $("#admin_edit_form").show();
            $("#admin_main").hide();
        }

        function hideForm(){
            $("#admin_edit_form").hide();
            $("#admin_main").show();
        }
    </script>

</body>
</html>